{% extends "base.html" %}

{% load i18n %}
{% load static %}

{% block content %}
<div ng-controller="MoviesSearchController" id="search" style="display: none">
    <div class="search-panel">
      <form name="search" id="search" ng-submit="search.$valid && submit()" novalidate>
        <div class="input-group">
          <input class="span2 form-control" id="query" name="query" type="text" autofocus ng-model="query" required>
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">{% trans 'Search' %}</button>
            <div class="btn-group">
              <button id="search-type-button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">[[ searchType ]] <span class="caret"></span></button>
              <ul class="dropdown-menu">
                <li><a href="javascript:void(0)" ng-click="changeSearchType(1);">{% trans 'Movie' %}</a></li>
                <li><a href="javascript:void(0)" ng-click="changeSearchType(2);">{% trans 'Actor' %}</a></li>
                <li><a href="javascript:void(0)" ng-click="changeSearchType(3);">{% trans 'Director' %}</a></li>
              </ul>
            </div>
          </span>
        </div>
        <div class="search-panel-additional">
          <label class="checkbox">
            <input type="checkbox" id="popular-only" checked> {% trans 'show only popular' %}<br>
          </label>
          <label class="checkbox">
            <input type="checkbox" id="sort-by-date"> {% trans 'sort by date' %}
          </label>
        </div>
      </form>
    </div>
    <div id="results" class="results" ng-repeat="searchResult in searchResults">
        <div class="movie" id="movie[[searchResult.id]]">
            <div class="poster"><img ng-src="[[searchResult.poster]]" alt="[[searchResult.title]] poster"/></div>
            <div class="title">"[[searchResult.title]]"
            <div class="add-to-list-buttons">
            <a href="javascript:void(0)" title="{% trans 'Add to the list' %} {% trans 'Watched' %}" ng-click="addToListFromDb(searchResult.id, 1)"><i class="fa fa-eye"></i></a>
            <a href="javascript:void(0)" title="{% trans 'Add to the list' %} {% trans 'To Watch' %}" ng-click="addToListFromDb(searchResult.id, 2)"><i class="fa fa-eye-slash"></i></a>
            </div></div>
            <div class="details" ng-show="searchResult.releaseDate">
                <strong>{% trans 'Release date' %}:</strong> [[searchResult.releaseDate]]
            </div>
        </div>
    </div>
    <div ng-show="nothingFound">{% trans 'Nothing has been found' %}.</div>
</div>
{% endblock %}

{% block js %}
<script>
  const urlSearchMovie = '{% url 'moviesapp.views.ajax_search_movie' %}';
  const urlAddToListFromDb = '{% url 'moviesapp.views.ajax_add_to_list_from_db' %}';
</script>
<script src="{% static 'js/search.js' %}"></script>
{% endblock %}
